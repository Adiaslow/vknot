import{j as r}from"./jsx-runtime.TBa3i5EZ.js";import{r as x}from"./index.CVf8TyFT.js";const c=60,o=8,G=10,w=1,$=1.5;function U(){const C=x.useRef(null),[m,b]=x.useState(()=>g()),[p,h]=x.useState(!1),[v,I]=x.useState(10),[M,y]=x.useState(0),[R,k]=x.useState(new Set),N=x.useRef(),j=x.useRef(0);function g(){return Array(c).fill(null).map(()=>Array(c).fill(0))}function F(){const a=g();for(let e=0;e<c;e++)for(let n=0;n<c;n++){const s=Math.random();s<.15?a[e][n]=1:s<.3&&(a[e][n]=2)}return a}function L(){const a=g(),e=Math.floor(c/2);for(let n=0;n<c;n++)for(let s=0;s<e;s++)Math.random()<.2&&(a[n][s]=1,a[n][c-1-s]=2);return a}function O(a,e,n){let s=0,t=0,l=0;for(let i=-1;i<=1;i++)for(let f=-1;f<=1;f++){if(i===0&&f===0)continue;const d=e+i,u=n+f;if(d>=0&&d<c&&u>=0&&u<c){const T=a[d][u];T===1?(s++,t++):T===2&&(s++,l++)}}return{total:s,playerA:t,playerB:l}}function _(a){const e=g(),n=new Set;for(let s=0;s<c;s++)for(let t=0;t<c;t++){const l=a[s][t],{total:i,playerA:f,playerB:d}=O(a,s,t);if(i<2){e[s][t]=0;continue}if(i>3){e[s][t]=0,l===1&&d>f?n.add(`${s},${t}`):l===2&&f>d&&n.add(`${s},${t}`);continue}if(l!==0){e[s][t]=l;continue}i===3&&(f>d?e[s][t]=1:d>f&&(e[s][t]=2))}return{newGrid:e,converted:n}}function A(a,e,n,s){let t=0;for(let l=0;l<c;l++)for(let i=0;i<c;i++)if(a[l][i]===s){const f=e-l,d=n-i,u=Math.sqrt(f*f+d*d);t+=Math.max(0,1-u*u/(G*G))}return t}function E(a,e,n){const s=A(a,e,n,1),t=A(a,e,n,2);return s>w&&t>w&&Math.abs(s-t)<$?"contested":s>w&&s>t?"playerA":t>w&&t>s?"playerB":"neutral"}const B=x.useCallback(()=>{const a=C.current;if(!a)return;const e=a.getContext("2d");if(!e)return;const n=c*o,s=c*o;e.clearRect(0,0,n,s);for(let t=0;t<c;t++)for(let l=0;l<c;l++){switch(E(m,t,l)){case"playerA":e.fillStyle="rgba(59, 130, 246, 0.15)";break;case"playerB":e.fillStyle="rgba(239, 68, 68, 0.15)";break;case"contested":e.fillStyle="rgba(250, 204, 21, 0.2)";break;default:e.fillStyle="rgba(255, 255, 255, 0)"}e.fillRect(l*o,t*o,o,o)}e.strokeStyle="rgba(203, 213, 225, 0.3)",e.lineWidth=1;for(let t=0;t<=c;t++)e.beginPath(),e.moveTo(0,t*o),e.lineTo(n,t*o),e.stroke(),e.beginPath(),e.moveTo(t*o,0),e.lineTo(t*o,s),e.stroke();for(let t=0;t<c;t++)for(let l=0;l<c;l++){const i=m[t][l];i===1?(e.fillStyle="#3b82f6",e.beginPath(),e.arc(l*o+o/2,t*o+o/2,o/3,0,2*Math.PI),e.fill()):i===2&&(e.fillStyle="#ef4444",e.beginPath(),e.arc(l*o+o/2,t*o+o/2,o/3,0,2*Math.PI),e.fill())}for(const t of R){const[l,i]=t.split(",").map(Number);e.fillStyle="#a855f7",e.beginPath(),e.arc(i*o+o/2,l*o+o/2,o/4,0,2*Math.PI),e.fill()}},[m,R]);x.useEffect(()=>{if(!p)return;const a=e=>{j.current||(j.current=e);const n=e-j.current,s=1e3/v;n>=s&&(b(t=>{const{newGrid:l,converted:i}=_(t);return k(i),l}),y(t=>t+1),j.current=e),N.current=requestAnimationFrame(a)};return N.current=requestAnimationFrame(a),()=>{N.current&&cancelAnimationFrame(N.current)}},[p,v]),x.useEffect(()=>{B()},[m,B]);const D=a=>{const e=C.current;if(!e||p)return;const n=e.getBoundingClientRect(),s=a.clientX-n.left,t=a.clientY-n.top,l=Math.floor(s/o),i=Math.floor(t/o);i>=0&&i<c&&l>=0&&l<c&&b(f=>{const d=f.map(u=>[...u]);return d[i][l]=(d[i][l]+1)%3,d})},P=m.flat().reduce((a,e)=>(e===1&&a.playerA++,e===2&&a.playerB++,a),{playerA:0,playerB:0}),S={playerA:0,playerB:0};for(let a=0;a<c;a++)for(let e=0;e<c;e++){const n=E(m,a,e);n==="playerA"&&S.playerA++,n==="playerB"&&S.playerB++}return r.jsxs("div",{className:"my-8 p-6 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 rounded-xl shadow-lg border border-slate-200 dark:border-slate-700",children:[r.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>h(!p),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors",children:p?"Pause":"Start"}),r.jsx("button",{onClick:()=>{h(!1),b(g()),y(0),k(new Set),j.current=0},className:"px-6 py-2 bg-slate-600 hover:bg-slate-700 text-white font-semibold rounded-lg transition-colors",children:"Reset"}),r.jsx("div",{className:"flex-1"}),r.jsx("button",{onClick:()=>{h(!1),b(g()),y(0),k(new Set)},className:"px-4 py-2 bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 text-slate-900 dark:text-slate-100 font-medium rounded-lg transition-colors",children:"Empty"}),r.jsx("button",{onClick:()=>{h(!1),b(F()),y(0),k(new Set)},className:"px-4 py-2 bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 text-slate-900 dark:text-slate-100 font-medium rounded-lg transition-colors",children:"Random"}),r.jsx("button",{onClick:()=>{h(!1),b(L()),y(0),k(new Set)},className:"px-4 py-2 bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 text-slate-900 dark:text-slate-100 font-medium rounded-lg transition-colors",children:"Symmetric"})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 min-w-[60px]",children:"Speed:"}),r.jsx("input",{type:"range",min:"1",max:"60",value:v,onChange:a=>I(Number(a.target.value)),className:"flex-1 h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),r.jsxs("span",{className:"text-sm font-mono text-slate-600 dark:text-slate-400 min-w-[80px]",children:[v," gen/sec"]})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[r.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Generation"}),r.jsx("div",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:M})]}),r.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[r.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 mb-1",children:"Player A"}),r.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:P.playerA}),r.jsxs("div",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:["Territory: ",S.playerA]})]}),r.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[r.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 mb-1",children:"Player B"}),r.jsx("div",{className:"text-xl font-bold text-red-600 dark:text-red-400",children:P.playerB}),r.jsxs("div",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:["Territory: ",S.playerB]})]})]}),r.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-slate-300 dark:border-slate-600 shadow-sm",children:[r.jsx("canvas",{ref:C,width:c*o,height:c*o,onClick:D,className:"cursor-pointer mx-auto block",style:{imageRendering:"pixelated"}}),!p&&r.jsx("p",{className:"text-center text-sm text-slate-600 dark:text-slate-400 mt-3",children:"Click cells to cycle: Empty → Player A (blue) → Player B (red)"})]}),r.jsxs("div",{className:"mt-4 text-sm text-slate-600 dark:text-slate-400",children:[r.jsx("p",{children:r.jsx("strong",{children:"Territory colors (background):"})}),r.jsxs("div",{className:"flex gap-4 mt-2 flex-wrap",children:[r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-4 h-4 rounded",style:{backgroundColor:"rgba(59, 130, 246, 0.15)"}}),"Player A territory"]}),r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-4 h-4 rounded",style:{backgroundColor:"rgba(239, 68, 68, 0.15)"}}),"Player B territory"]}),r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-4 h-4 rounded",style:{backgroundColor:"rgba(250, 204, 21, 0.2)"}}),"Contested"]}),r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-4 h-4 rounded bg-purple-500 opacity-70"}),"Competitive death"]})]})]})]})}export{U as default};
