import{j as r}from"./jsx-runtime.TBa3i5EZ.js";import{r as u}from"./index.CVf8TyFT.js";const o=60,i=8,E=15,N=1,O=.3;function q(){const C=u.useRef(null),[h,m]=u.useState(()=>g()),[b,p]=u.useState(!1),[j,P]=u.useState(10),[B,y]=u.useState(0),v=u.useRef(),k=u.useRef(0);function g(){return Array(o).fill(null).map(()=>Array(o).fill(0))}function G(){const l=g();for(let e=0;e<o;e++)for(let a=0;a<o;a++){const s=Math.random();s<.15?l[e][a]=1:s<.3&&(l[e][a]=2)}return l}function I(){const l=g(),e=Math.floor(o/2);for(let a=0;a<o;a++)for(let s=0;s<e;s++)Math.random()<.2&&(l[a][s]=1,l[a][o-1-s]=2);return l}function T(l,e,a){let s=0,t=0,n=0;for(let c=-1;c<=1;c++)for(let d=-1;d<=1;d++){if(c===0&&d===0)continue;const f=e+c,x=a+d;if(f>=0&&f<o&&x>=0&&x<o){const A=l[f][x];A===1?(s++,t++):A===2&&(s++,n++)}}return{total:s,playerA:t,playerB:n}}function M(l){const e=g();for(let a=0;a<o;a++)for(let s=0;s<o;s++){const t=l[a][s],{total:n,playerA:c,playerB:d}=T(l,a,s);if(n<2||n>3){e[a][s]=0;continue}(t!==0&&(n===2||n===3)||t===0&&n===3)&&(c===d?e[a][s]=t:c>d?e[a][s]=1:e[a][s]=2)}return e}function S(l,e,a,s){let t=0;for(let n=0;n<o;n++)for(let c=0;c<o;c++)if(l[n][c]===s){const d=e-n,f=a-c,x=Math.sqrt(d*d+f*f);t+=Math.max(0,1-x*x/(E*E))}return t}function F(l,e,a){const s=S(l,e,a,1),t=S(l,e,a,2);return s>N&&t>N&&Math.abs(s-t)<O?"contested":s>N&&s>t?"playerA":t>N&&t>s?"playerB":"neutral"}const R=u.useCallback(()=>{const l=C.current;if(!l)return;const e=l.getContext("2d");if(!e)return;const a=o*i,s=o*i;e.clearRect(0,0,a,s);for(let t=0;t<o;t++)for(let n=0;n<o;n++){switch(F(h,t,n)){case"playerA":e.fillStyle="rgba(59, 130, 246, 0.15)";break;case"playerB":e.fillStyle="rgba(239, 68, 68, 0.15)";break;case"contested":e.fillStyle="rgba(168, 85, 247, 0.15)";break;default:e.fillStyle="rgba(255, 255, 255, 0)"}e.fillRect(n*i,t*i,i,i)}e.strokeStyle="rgba(203, 213, 225, 0.3)",e.lineWidth=1;for(let t=0;t<=o;t++)e.beginPath(),e.moveTo(0,t*i),e.lineTo(a,t*i),e.stroke(),e.beginPath(),e.moveTo(t*i,0),e.lineTo(t*i,s),e.stroke();for(let t=0;t<o;t++)for(let n=0;n<o;n++){const c=h[t][n];c===1?(e.fillStyle="#3b82f6",e.beginPath(),e.arc(n*i+i/2,t*i+i/2,i/3,0,2*Math.PI),e.fill()):c===2&&(e.fillStyle="#ef4444",e.beginPath(),e.arc(n*i+i/2,t*i+i/2,i/3,0,2*Math.PI),e.fill())}},[h]);u.useEffect(()=>{if(!b)return;const l=e=>{k.current||(k.current=e);const a=e-k.current,s=1e3/j;a>=s&&(m(t=>M(t)),y(t=>t+1),k.current=e),v.current=requestAnimationFrame(l)};return v.current=requestAnimationFrame(l),()=>{v.current&&cancelAnimationFrame(v.current)}},[b,j]),u.useEffect(()=>{R()},[h,R]);const L=l=>{const e=C.current;if(!e||b)return;const a=e.getBoundingClientRect(),s=l.clientX-a.left,t=l.clientY-a.top,n=Math.floor(s/i),c=Math.floor(t/i);c>=0&&c<o&&n>=0&&n<o&&m(d=>{const f=d.map(x=>[...x]);return f[c][n]=(f[c][n]+1)%3,f})},w=h.flat().reduce((l,e)=>(e===1&&l.playerA++,e===2&&l.playerB++,l),{playerA:0,playerB:0});return r.jsxs("div",{className:"my-8 p-6 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 rounded-xl shadow-lg border border-slate-200 dark:border-slate-700",children:[r.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>p(!b),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors",children:b?"Pause":"Start"}),r.jsx("button",{onClick:()=>{p(!1),m(g()),y(0),k.current=0},className:"px-6 py-2 bg-slate-600 hover:bg-slate-700 text-white font-semibold rounded-lg transition-colors",children:"Reset"}),r.jsx("div",{className:"flex-1"}),r.jsx("button",{onClick:()=>{p(!1),m(g()),y(0)},className:"px-4 py-2 bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 text-slate-900 dark:text-slate-100 font-medium rounded-lg transition-colors",children:"Empty"}),r.jsx("button",{onClick:()=>{p(!1),m(G()),y(0)},className:"px-4 py-2 bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 text-slate-900 dark:text-slate-100 font-medium rounded-lg transition-colors",children:"Random"}),r.jsx("button",{onClick:()=>{p(!1),m(I()),y(0)},className:"px-4 py-2 bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 text-slate-900 dark:text-slate-100 font-medium rounded-lg transition-colors",children:"Symmetric"})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 min-w-[60px]",children:"Speed:"}),r.jsx("input",{type:"range",min:"1",max:"60",value:j,onChange:l=>P(Number(l.target.value)),className:"flex-1 h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),r.jsxs("span",{className:"text-sm font-mono text-slate-600 dark:text-slate-400 min-w-[80px]",children:[j," gen/sec"]})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[r.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Generation"}),r.jsx("div",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:B})]}),r.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[r.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 mb-1",children:"Player A (Blue)"}),r.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:w.playerA})]}),r.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[r.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 mb-1",children:"Player B (Red)"}),r.jsx("div",{className:"text-xl font-bold text-red-600 dark:text-red-400",children:w.playerB})]})]}),r.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-slate-300 dark:border-slate-600 shadow-sm",children:[r.jsx("canvas",{ref:C,width:o*i,height:o*i,onClick:L,className:"cursor-pointer mx-auto block",style:{imageRendering:"pixelated"}}),!b&&r.jsx("p",{className:"text-center text-sm text-slate-600 dark:text-slate-400 mt-3",children:"Click cells to cycle: Empty → Player A (blue) → Player B (red)"})]}),r.jsxs("div",{className:"mt-4 text-sm text-slate-600 dark:text-slate-400",children:[r.jsx("p",{children:r.jsx("strong",{children:"Territory colors (background):"})}),r.jsxs("div",{className:"flex gap-4 mt-2",children:[r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-4 h-4 rounded",style:{backgroundColor:"rgba(59, 130, 246, 0.15)"}}),"Player A territory"]}),r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-4 h-4 rounded",style:{backgroundColor:"rgba(239, 68, 68, 0.15)"}}),"Player B territory"]}),r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-4 h-4 rounded",style:{backgroundColor:"rgba(168, 85, 247, 0.15)"}}),"Contested"]})]})]})]})}export{q as default};
