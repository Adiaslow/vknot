import{j as t}from"./jsx-runtime.TBa3i5EZ.js";import{r as i}from"./index.CVf8TyFT.js";import{s as D,l as F,a as Y,f as C,b as G}from"./transform.Cr_jfbQC.js";import{l as I,m as O}from"./monotone.CFQ88-W1.js";function V(a){let e;for(;e=a.sourceEvent;)a=e;return a}function q(a,e){if(a=V(a),e===void 0&&(e=a.currentTarget),e){var h=e.ownerSVGElement||e;if(h.createSVGPoint){var r=h.createSVGPoint();return r.x=a.clientX,r.y=a.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var f=e.getBoundingClientRect();return[a.clientX-f.left-e.clientLeft,a.clientY-f.top-e.clientTop]}}return[a.pageX,a.pageY]}function H(a){const e=1/(1+.2316419*Math.abs(a)),r=.3989423*Math.exp(-a*a/2)*e*(.3193815+e*(-.3565638+e*(1.781478+e*(-1.821256+e*1.330274))));return a>0?1-r:r}function W(a,e){if(e===0)return 1;if(a<0)return 0;const h=Math.floor(a);if(e>100){const n=(h+.5-e)/Math.sqrt(e);return H(n)}let r=0,f=Math.exp(-e);for(let n=0;n<=h;n++)r+=f,n<h&&(f*=e/(n+1));return Math.min(1,r)}function tt(){const a=i.useRef(null),[e,h]=i.useState(1e4),[r,f]=i.useState(100),[n,T]=i.useState(.05),v=i.useMemo(()=>e*r,[e,r]),b=i.useMemo(()=>d=>{const p=e*Math.exp(-d*r);return W(n*e,p)},[e,r,n]),s=i.useMemo(()=>Math.log(1/n)/r,[n,r]),w=i.useMemo(()=>Math.ceil(s*v),[s,v]),R=i.useMemo(()=>e/w,[e,w]),z=i.useMemo(()=>b(s),[b,s]),m=i.useMemo(()=>Math.log(1/(n+1/e))/r,[n,e,r]),M=i.useMemo(()=>(m-s)/s*100,[m,s]),k=i.useMemo(()=>{const d=[],u=Math.min(s*3,1);for(let x=0;x<=200;x++){const l=x/200*u;d.push({alpha:l,probability:b(l)})}return d},[s,b]);return i.useEffect(()=>{if(!a.current||k.length===0)return;const d=D(a.current);d.selectAll("*").remove();const p={top:40,right:40,bottom:60,left:70},u=700-p.left-p.right,x=450-p.top-p.bottom,l=d.append("g").attr("transform",`translate(${p.left},${p.top})`),N=Math.max(...k.map(c=>c.alpha)),o=F().domain([0,N]).range([0,u]),g=F().domain([0,1]).range([x,0]),$=Y(o).ticks(10).tickFormat(c=>C(".3f")(c)),_=G(g).ticks(10).tickFormat(c=>C(".0%")(c));l.append("g").attr("transform",`translate(0,${x})`).call($).style("font-size","12px"),l.append("g").call(_).style("font-size","12px"),l.append("text").attr("x",u/2).attr("y",x+45).attr("text-anchor","middle").style("font-size","14px").style("font-weight","600").text("Sampling Fraction α = n/|S|"),l.append("text").attr("transform","rotate(-90)").attr("x",-x/2).attr("y",-50).attr("text-anchor","middle").style("font-size","14px").style("font-weight","600").text("Probability P(Coverage ≥ 1-ε)");const S=.15,E=Math.max(0,s-s*S),A=Math.min(N,s+s*S);l.append("rect").attr("x",o(E)).attr("y",0).attr("width",o(A)-o(E)).attr("height",x).attr("fill","rgba(250, 204, 21, 0.1)").attr("stroke","rgba(250, 204, 21, 0.3)").attr("stroke-width",1).attr("stroke-dasharray","5,5");const U=I().x(c=>o(c.alpha)).y(c=>g(c.probability)).curve(O);l.append("path").datum(k).attr("fill","none").attr("stroke","#3b82f6").attr("stroke-width",3).attr("d",U),l.append("line").attr("x1",o(s)).attr("x2",o(s)).attr("y1",0).attr("y2",x).attr("stroke","#ef4444").attr("stroke-width",2).attr("stroke-dasharray","8,4");const L=b(s);if(l.append("circle").attr("cx",o(s)).attr("cy",g(L)).attr("r",6).attr("fill","#ef4444").attr("stroke","#fff").attr("stroke-width",2),l.append("text").attr("x",o(s)).attr("y",-10).attr("text-anchor","middle").style("font-size","12px").style("font-weight","600").style("fill","#ef4444").text(`α_c = ${s.toExponential(2)}`),Math.abs(m-s)/s>.001){l.append("line").attr("x1",o(m)).attr("x2",o(m)).attr("y1",0).attr("y2",x).attr("stroke","#f97316").attr("stroke-width",2).attr("stroke-dasharray","4,4");const c=b(m);l.append("circle").attr("cx",o(m)).attr("cy",g(c)).attr("r",5).attr("fill","#f97316").attr("stroke","#fff").attr("stroke-width",2),l.append("text").attr("x",o(m)).attr("y",-25).attr("text-anchor","middle").style("font-size","11px").style("font-weight","600").style("fill","#f97316").text(`α_infl = ${m.toExponential(2)}`)}const j=l.append("g").attr("class","tooltip").style("display","none");j.append("circle").attr("r",4).attr("fill","#3b82f6");const X=j.append("text").attr("x",10).attr("y",-10).style("font-size","12px").style("font-weight","600");l.append("rect").attr("width",u).attr("height",x).attr("fill","none").attr("pointer-events","all").on("mousemove",function(c){const[B]=q(c),y=o.invert(B);if(y>=0&&y<=N){const P=b(y);j.style("display",null).attr("transform",`translate(${o(y)},${g(P)})`),X.text(`α=${y.toFixed(4)}, P=${(P*100).toFixed(1)}%`)}}).on("mouseout",function(){j.style("display","none")})},[k,s,m,b]),t.jsxs("div",{className:"my-8 p-6 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 rounded-xl shadow-lg border border-slate-200 dark:border-slate-700",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"Phase Transition Explorer"}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Explore the sharp phase transition in probability P(Coverage ≥ 1-ε) at critical threshold α_c. Adjust parameters to see the dramatic S-curve behavior predicted by Theorem 4.1."})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:["Library Size |U|: ",e.toLocaleString()]}),t.jsx("input",{type:"range",min:"1000",max:"1000000",step:"1000",value:e,onChange:d=>h(Number(d.target.value)),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-500 mt-1",children:[t.jsx("span",{children:"10³"}),t.jsx("span",{children:"10⁶"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:["Redundancy R: ",r.toLocaleString()]}),t.jsx("input",{type:"range",min:"10",max:"10000",step:"10",value:r,onChange:d=>f(Number(d.target.value)),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-500 mt-1",children:[t.jsx("span",{children:"10"}),t.jsx("span",{children:"10⁴"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:["Target ε: ",n.toFixed(3)]}),t.jsx("input",{type:"range",min:"0.001",max:"0.5",step:"0.001",value:n,onChange:d=>T(Number(d.target.value)),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-500 mt-1",children:[t.jsx("span",{children:"0.001"}),t.jsx("span",{children:"0.5"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Synthesis Space"}),t.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:v.toExponential(2)})]}),t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Samples Needed"}),t.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:w.toLocaleString()})]}),t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Speedup Factor"}),t.jsxs("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:[R.toFixed(1),"×"]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg border border-yellow-300 dark:border-yellow-700",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Theoretical α_c"}),t.jsx("div",{className:"text-lg font-bold text-red-600 dark:text-red-400",children:s.toExponential(3)})]}),t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg border border-yellow-300 dark:border-yellow-700",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"True Inflection"}),t.jsx("div",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:m.toExponential(3)})]}),t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg border border-yellow-300 dark:border-yellow-700",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"P(α_c)"}),t.jsxs("div",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:[(z*100).toFixed(1),"%"]})]}),t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg border border-yellow-300 dark:border-yellow-700",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Offset"}),t.jsxs("div",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:[Math.abs(M)<.01?"< 0.01":M.toFixed(2),"%"]})]})]}),t.jsx("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-slate-300 dark:border-slate-600",children:t.jsx("svg",{ref:a,width:700,height:450,className:"mx-auto"})}),t.jsxs("div",{className:"mt-4 text-sm text-slate-600 dark:text-slate-400",children:[t.jsx("p",{children:t.jsx("strong",{children:"Interpretation:"})}),t.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[t.jsxs("li",{children:[t.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-semibold",children:"Blue curve"}),": Probability P(Coverage ≥ 1-ε) using exact Poisson CDF from Theorem 4.1"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-red-600 dark:text-red-400 font-semibold",children:"Red line"}),": Theoretical critical threshold α_c = log(1/ε)/R (where E[uncovered] = ε|U|)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-orange-600 dark:text-orange-400 font-semibold",children:"Orange line"}),": True inflection point α_infl = log(1/(ε + 1/|U|))/R (from calculus, shown if different)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-yellow-600 dark:text-yellow-400 font-semibold",children:"Yellow region"}),": Phase transition zone exhibiting sharp S-curve behavior"]}),t.jsx("li",{children:"For large |U|, α_c ≈ α_infl (offset → 0%). For small |U|, the offset is measurable."}),t.jsx("li",{children:"Hover over the curve to see exact probability values at each sampling fraction"})]})]})]})}export{tt as default};
