import{j as t}from"./jsx-runtime.TBa3i5EZ.js";import{r as x}from"./index.CVf8TyFT.js";import{s as B,l as P,a as Y,f as C,b as _}from"./transform.Cr_jfbQC.js";import{l as D,m as G}from"./monotone.CFQ88-W1.js";function U(a){let e;for(;e=a.sourceEvent;)a=e;return a}function V(a,e){if(a=U(a),e===void 0&&(e=a.currentTarget),e){var p=e.ownerSVGElement||e;if(p.createSVGPoint){var s=p.createSVGPoint();return s.x=a.clientX,s.y=a.clientY,s=s.matrixTransform(e.getScreenCTM().inverse()),[s.x,s.y]}if(e.getBoundingClientRect){var h=e.getBoundingClientRect();return[a.clientX-h.left-e.clientLeft,a.clientY-h.top-e.clientTop]}}return[a.pageX,a.pageY]}function H(a,e){if(e===0)return 1;if(a<0)return 0;let p=0,s=Math.exp(-e);const h=Math.floor(a);for(let i=0;i<=h;i++)p+=s,i<h&&(s*=e/(i+1));return p}function K(){const a=x.useRef(null),[e,p]=x.useState(1e4),[s,h]=x.useState(100),[i,E]=x.useState(.05),k=x.useMemo(()=>e*s,[e,s]),u=x.useMemo(()=>n=>{const m=e*Math.exp(-n*s);return H(i*e,m)},[e,s,i]),r=x.useMemo(()=>Math.log(1/i)/s,[i,s]),v=x.useMemo(()=>Math.ceil(r*k),[r,k]),F=x.useMemo(()=>e/v,[e,v]),f=x.useMemo(()=>{const n=[],b=Math.min(r*3,1);for(let o=0;o<=200;o++){const l=o/200*b;n.push({alpha:l,probability:u(l)})}return n},[r,u]);return x.useEffect(()=>{if(!a.current||f.length===0)return;const n=B(a.current);n.selectAll("*").remove();const m={top:40,right:40,bottom:60,left:70},b=700-m.left-m.right,o=450-m.top-m.bottom,l=n.append("g").attr("transform",`translate(${m.left},${m.top})`),N=Math.max(...f.map(c=>c.alpha)),d=P().domain([0,N]).range([0,b]),j=P().domain([0,1]).range([o,0]),R=Y(d).ticks(10).tickFormat(c=>C(".3f")(c)),T=_(j).ticks(10).tickFormat(c=>C(".0%")(c));l.append("g").attr("transform",`translate(0,${o})`).call(R).style("font-size","12px"),l.append("g").call(T).style("font-size","12px"),l.append("text").attr("x",b/2).attr("y",o+45).attr("text-anchor","middle").style("font-size","14px").style("font-weight","600").text("Sampling Fraction α = n/|S|"),l.append("text").attr("transform","rotate(-90)").attr("x",-o/2).attr("y",-50).attr("text-anchor","middle").style("font-size","14px").style("font-weight","600").text("Probability P(Coverage ≥ 1-ε)");const w=.15,S=Math.max(0,r-r*w),$=Math.min(N,r+r*w);l.append("rect").attr("x",d(S)).attr("y",0).attr("width",d($)-d(S)).attr("height",o).attr("fill","rgba(250, 204, 21, 0.1)").attr("stroke","rgba(250, 204, 21, 0.3)").attr("stroke-width",1).attr("stroke-dasharray","5,5");const z=D().x(c=>d(c.alpha)).y(c=>j(c.probability)).curve(G);l.append("path").datum(f).attr("fill","none").attr("stroke","#3b82f6").attr("stroke-width",3).attr("d",z),l.append("line").attr("x1",d(r)).attr("x2",d(r)).attr("y1",0).attr("y2",o).attr("stroke","#ef4444").attr("stroke-width",2).attr("stroke-dasharray","8,4");const A=u(r);l.append("circle").attr("cx",d(r)).attr("cy",j(A)).attr("r",6).attr("fill","#ef4444").attr("stroke","#fff").attr("stroke-width",2),l.append("text").attr("x",d(r)).attr("y",-10).attr("text-anchor","middle").style("font-size","12px").style("font-weight","600").style("fill","#ef4444").text(`α_c = ${r.toExponential(2)}`);const y=l.append("g").attr("class","tooltip").style("display","none");y.append("circle").attr("r",4).attr("fill","#3b82f6");const L=y.append("text").attr("x",10).attr("y",-10).style("font-size","12px").style("font-weight","600");l.append("rect").attr("width",b).attr("height",o).attr("fill","none").attr("pointer-events","all").on("mousemove",function(c){const[X]=V(c),g=d.invert(X);if(g>=0&&g<=N){const M=u(g);y.style("display",null).attr("transform",`translate(${d(g)},${j(M)})`),L.text(`α=${g.toFixed(4)}, P=${(M*100).toFixed(1)}%`)}}).on("mouseout",function(){y.style("display","none")})},[f,r,u]),t.jsxs("div",{className:"my-8 p-6 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 rounded-xl shadow-lg border border-slate-200 dark:border-slate-700",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"Phase Transition Explorer"}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Explore the sharp phase transition in probability P(Coverage ≥ 1-ε) at critical threshold α_c. Adjust parameters to see the dramatic S-curve behavior predicted by Theorem 4.1."})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:["Library Size |U|: ",e.toLocaleString()]}),t.jsx("input",{type:"range",min:"1000",max:"1000000",step:"1000",value:e,onChange:n=>p(Number(n.target.value)),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-500 mt-1",children:[t.jsx("span",{children:"10³"}),t.jsx("span",{children:"10⁶"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:["Redundancy R: ",s.toLocaleString()]}),t.jsx("input",{type:"range",min:"10",max:"10000",step:"10",value:s,onChange:n=>h(Number(n.target.value)),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-500 mt-1",children:[t.jsx("span",{children:"10"}),t.jsx("span",{children:"10⁴"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:["Target ε: ",i.toFixed(3)]}),t.jsx("input",{type:"range",min:"0.001",max:"0.5",step:"0.001",value:i,onChange:n=>E(Number(n.target.value)),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-500 mt-1",children:[t.jsx("span",{children:"0.001"}),t.jsx("span",{children:"0.5"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Synthesis Space"}),t.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:k.toExponential(2)})]}),t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Critical α_c"}),t.jsx("div",{className:"text-lg font-bold text-red-600 dark:text-red-400",children:r.toExponential(2)})]}),t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Samples Needed"}),t.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:v.toLocaleString()})]}),t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Speedup Factor"}),t.jsxs("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:[F.toFixed(1),"×"]})]})]}),t.jsx("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-slate-300 dark:border-slate-600",children:t.jsx("svg",{ref:a,width:700,height:450,className:"mx-auto"})}),t.jsxs("div",{className:"mt-4 text-sm text-slate-600 dark:text-slate-400",children:[t.jsx("p",{children:t.jsx("strong",{children:"Interpretation:"})}),t.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[t.jsxs("li",{children:[t.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-semibold",children:"Blue curve"}),": Probability P(Coverage ≥ 1-ε) using exact Poisson CDF from Theorem 4.1"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-red-600 dark:text-red-400 font-semibold",children:"Red line"}),": Critical threshold α_c = log(1/ε)/R where phase transition occurs"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-yellow-600 dark:text-yellow-400 font-semibold",children:"Yellow region"}),": Phase transition zone exhibiting sharp S-curve behavior"]}),t.jsx("li",{children:"Hover over the curve to see exact probability values at each sampling fraction"})]})]})]})}export{K as default};
