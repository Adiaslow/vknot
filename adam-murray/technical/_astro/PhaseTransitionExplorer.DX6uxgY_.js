import{j as t}from"./jsx-runtime.TBa3i5EZ.js";import{r as c}from"./index.CVf8TyFT.js";import{s as B,l as E,a as Y,f as M,b as G}from"./transform.Cr_jfbQC.js";import{l as U,m as V}from"./monotone.CFQ88-W1.js";function _(a){let e;for(;e=a.sourceEvent;)a=e;return a}function D(a,e){if(a=_(a),e===void 0&&(e=a.currentTarget),e){var u=e.ownerSVGElement||e;if(u.createSVGPoint){var r=u.createSVGPoint();return r.x=a.clientX,r.y=a.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var g=e.getBoundingClientRect();return[a.clientX-g.left-e.clientLeft,a.clientY-g.top-e.clientTop]}}return[a.pageX,a.pageY]}function J(){const a=c.useRef(null),[e,u]=c.useState(1e4),[r,g]=c.useState(100),[b,R]=c.useState(.05),v=c.useMemo(()=>e*r,[e,r]),m=c.useMemo(()=>n=>1-Math.exp(-n*r),[r]),s=c.useMemo(()=>Math.log(1/b)/r,[b,r]),y=c.useMemo(()=>Math.ceil(s*v),[s,v]),F=c.useMemo(()=>e/y,[e,y]),f=c.useMemo(()=>{const n=[],p=Math.min(s*3,1);for(let i=0;i<=200;i++){const l=i/200*p;n.push({alpha:l,coverage:m(l)})}return n},[s,m]);return c.useEffect(()=>{if(!a.current||f.length===0)return;const n=B(a.current);n.selectAll("*").remove();const x={top:40,right:40,bottom:60,left:70},p=700-x.left-x.right,i=450-x.top-x.bottom,l=n.append("g").attr("transform",`translate(${x.left},${x.top})`),N=Math.max(...f.map(d=>d.alpha)),o=E().domain([0,N]).range([0,p]),j=E().domain([0,1]).range([i,0]),$=Y(o).ticks(10).tickFormat(d=>M(".3f")(d)),z=G(j).ticks(10).tickFormat(d=>M(".0%")(d));l.append("g").attr("transform",`translate(0,${i})`).call($).style("font-size","12px"),l.append("g").call(z).style("font-size","12px"),l.append("text").attr("x",p/2).attr("y",i+45).attr("text-anchor","middle").style("font-size","14px").style("font-weight","600").text("Sampling Fraction α = n/|S|"),l.append("text").attr("transform","rotate(-90)").attr("x",-i/2).attr("y",-50).attr("text-anchor","middle").style("font-size","14px").style("font-weight","600").text("Coverage C(α)");const w=.15,S=Math.max(0,s-s*w),P=Math.min(N,s+s*w);l.append("rect").attr("x",o(S)).attr("y",0).attr("width",o(P)-o(S)).attr("height",i).attr("fill","rgba(250, 204, 21, 0.1)").attr("stroke","rgba(250, 204, 21, 0.3)").attr("stroke-width",1).attr("stroke-dasharray","5,5");const T=U().x(d=>o(d.alpha)).y(d=>j(d.coverage)).curve(V);l.append("path").datum(f).attr("fill","none").attr("stroke","#3b82f6").attr("stroke-width",3).attr("d",T),l.append("line").attr("x1",o(s)).attr("x2",o(s)).attr("y1",0).attr("y2",i).attr("stroke","#ef4444").attr("stroke-width",2).attr("stroke-dasharray","8,4");const A=m(s);l.append("circle").attr("cx",o(s)).attr("cy",j(A)).attr("r",6).attr("fill","#ef4444").attr("stroke","#fff").attr("stroke-width",2),l.append("text").attr("x",o(s)).attr("y",-10).attr("text-anchor","middle").style("font-size","12px").style("font-weight","600").style("fill","#ef4444").text(`α_c = ${s.toExponential(2)}`);const k=l.append("g").attr("class","tooltip").style("display","none");k.append("circle").attr("r",4).attr("fill","#3b82f6");const L=k.append("text").attr("x",10).attr("y",-10).style("font-size","12px").style("font-weight","600");l.append("rect").attr("width",p).attr("height",i).attr("fill","none").attr("pointer-events","all").on("mousemove",function(d){const[X]=D(d),h=o.invert(X);if(h>=0&&h<=N){const C=m(h);k.style("display",null).attr("transform",`translate(${o(h)},${j(C)})`),L.text(`α=${h.toFixed(4)}, C=${(C*100).toFixed(1)}%`)}}).on("mouseout",function(){k.style("display","none")})},[f,s,m]),t.jsxs("div",{className:"my-8 p-6 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 rounded-xl shadow-lg border border-slate-200 dark:border-slate-700",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"Phase Transition Explorer"}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Explore how sampling efficiency exhibits sharp phase transitions at critical thresholds. Adjust parameters to see the dramatic S-curve behavior."})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:["Library Size |U|: ",e.toLocaleString()]}),t.jsx("input",{type:"range",min:"1000",max:"1000000",step:"1000",value:e,onChange:n=>u(Number(n.target.value)),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-500 mt-1",children:[t.jsx("span",{children:"10³"}),t.jsx("span",{children:"10⁶"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:["Redundancy R: ",r.toLocaleString()]}),t.jsx("input",{type:"range",min:"10",max:"10000",step:"10",value:r,onChange:n=>g(Number(n.target.value)),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-500 mt-1",children:[t.jsx("span",{children:"10"}),t.jsx("span",{children:"10⁴"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:["Target ε: ",b.toFixed(3)]}),t.jsx("input",{type:"range",min:"0.001",max:"0.5",step:"0.001",value:b,onChange:n=>R(Number(n.target.value)),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-500 mt-1",children:[t.jsx("span",{children:"0.001"}),t.jsx("span",{children:"0.5"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Synthesis Space"}),t.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:v.toExponential(2)})]}),t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Critical α_c"}),t.jsx("div",{className:"text-lg font-bold text-red-600 dark:text-red-400",children:s.toExponential(2)})]}),t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Samples Needed"}),t.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:y.toLocaleString()})]}),t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Speedup Factor"}),t.jsxs("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:[F.toFixed(1),"×"]})]})]}),t.jsx("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-slate-300 dark:border-slate-600",children:t.jsx("svg",{ref:a,width:700,height:450,className:"mx-auto"})}),t.jsxs("div",{className:"mt-4 text-sm text-slate-600 dark:text-slate-400",children:[t.jsx("p",{children:t.jsx("strong",{children:"Interpretation:"})}),t.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[t.jsxs("li",{children:[t.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-semibold",children:"Blue curve"}),": Coverage function C(α) = 1 - exp(-αR)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-red-600 dark:text-red-400 font-semibold",children:"Red line"}),": Critical threshold α_c where phase transition occurs"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-yellow-600 dark:text-yellow-400 font-semibold",children:"Yellow region"}),": Phase transition zone (sharp S-curve)"]}),t.jsx("li",{children:"Hover over the curve to see exact coverage values"})]})]})]})}export{J as default};
