import{j as t}from"./jsx-runtime.TBa3i5EZ.js";import{r as o}from"./index.CVf8TyFT.js";import{s as B,l as R,a as D,f as F,b as G}from"./transform.Cr_jfbQC.js";import{l as I,m as Y}from"./monotone.CFQ88-W1.js";function O(a){let e;for(;e=a.sourceEvent;)a=e;return a}function V(a,e){if(a=O(a),e===void 0&&(e=a.currentTarget),e){var h=e.ownerSVGElement||e;if(h.createSVGPoint){var s=h.createSVGPoint();return s.x=a.clientX,s.y=a.clientY,s=s.matrixTransform(e.getScreenCTM().inverse()),[s.x,s.y]}if(e.getBoundingClientRect){var u=e.getBoundingClientRect();return[a.clientX-u.left-e.clientLeft,a.clientY-u.top-e.clientTop]}}return[a.pageX,a.pageY]}function H(a){const e=1/(1+.2316419*Math.abs(a)),s=.3989423*Math.exp(-a*a/2)*e*(.3193815+e*(-.3565638+e*(1.781478+e*(-1.821256+e*1.330274))));return a>0?1-s:s}function W(a,e){if(e===0)return 1;if(a<0)return 0;const h=Math.floor(a);if(e>100){const n=(h+.5-e)/Math.sqrt(e);return H(n)}let s=0,u=Math.exp(-e);for(let n=0;n<=h;n++)s+=u,n<h&&(u*=e/(n+1));return Math.min(1,s)}function tt(){const a=o.useRef(null),[e,h]=o.useState(1e4),[s,u]=o.useState(100),[n,T]=o.useState(.05),g=o.useMemo(()=>e*s,[e,s]),b=o.useMemo(()=>d=>{const p=e*Math.exp(-d*s);return W(n*e,p)},[e,s,n]),r=o.useMemo(()=>Math.log(1/n)/s,[n,s]),N=o.useMemo(()=>Math.ceil(r*g),[r,g]),w=o.useMemo(()=>g/N,[g,N]),U=o.useMemo(()=>b(r),[b,r]),m=o.useMemo(()=>Math.log(1/(n+1/e))/s,[n,e,s]),M=o.useMemo(()=>(m-r)/r*100,[m,r]),k=o.useMemo(()=>{const d=[],f=Math.min(r*3,1);for(let x=0;x<=200;x++){const l=x/200*f;d.push({alpha:l,probability:b(l)})}return d},[r,b]);return o.useEffect(()=>{if(!a.current||k.length===0)return;const d=B(a.current);d.selectAll("*").remove();const p={top:40,right:40,bottom:60,left:70},f=700-p.left-p.right,x=450-p.top-p.bottom,l=d.append("g").attr("transform",`translate(${p.left},${p.top})`),S=Math.max(...k.map(c=>c.alpha)),i=R().domain([0,S]).range([0,f]),y=R().domain([0,1]).range([x,0]),_=D(i).ticks(10).tickFormat(c=>F(".3f")(c)),$=G(y).ticks(10).tickFormat(c=>F(".0%")(c));l.append("g").attr("transform",`translate(0,${x})`).call(_).style("font-size","12px"),l.append("g").call($).style("font-size","12px"),l.append("text").attr("x",f/2).attr("y",x+45).attr("text-anchor","middle").style("font-size","14px").style("font-weight","600").text("Sampling Fraction α = n/|S|"),l.append("text").attr("transform","rotate(-90)").attr("x",-x/2).attr("y",-50).attr("text-anchor","middle").style("font-size","14px").style("font-weight","600").text("Probability P(Coverage ≥ 1-ε)");const P=.15,E=Math.max(0,r-r*P),z=Math.min(S,r+r*P);l.append("rect").attr("x",i(E)).attr("y",0).attr("width",i(z)-i(E)).attr("height",x).attr("fill","rgba(250, 204, 21, 0.1)").attr("stroke","rgba(250, 204, 21, 0.3)").attr("stroke-width",1).attr("stroke-dasharray","5,5");const A=I().x(c=>i(c.alpha)).y(c=>y(c.probability)).curve(Y);l.append("path").datum(k).attr("fill","none").attr("stroke","#3b82f6").attr("stroke-width",3).attr("d",A),l.append("line").attr("x1",i(r)).attr("x2",i(r)).attr("y1",0).attr("y2",x).attr("stroke","#ef4444").attr("stroke-width",2).attr("stroke-dasharray","8,4");const L=b(r);if(l.append("circle").attr("cx",i(r)).attr("cy",y(L)).attr("r",6).attr("fill","#ef4444").attr("stroke","#fff").attr("stroke-width",2),l.append("text").attr("x",i(r)).attr("y",-10).attr("text-anchor","middle").style("font-size","12px").style("font-weight","600").style("fill","#ef4444").text(`α_c = ${r.toExponential(2)}`),Math.abs(m-r)/r>.001){l.append("line").attr("x1",i(m)).attr("x2",i(m)).attr("y1",0).attr("y2",x).attr("stroke","#f97316").attr("stroke-width",2).attr("stroke-dasharray","4,4");const c=b(m);l.append("circle").attr("cx",i(m)).attr("cy",y(c)).attr("r",5).attr("fill","#f97316").attr("stroke","#fff").attr("stroke-width",2),l.append("text").attr("x",i(m)).attr("y",-25).attr("text-anchor","middle").style("font-size","11px").style("font-weight","600").style("fill","#f97316").text(`α_infl = ${m.toExponential(2)}`)}const v=l.append("g").attr("class","tooltip").style("display","none");v.append("circle").attr("r",4).attr("fill","#3b82f6");const X=v.append("text").attr("x",10).attr("y",-10).style("font-size","12px").style("font-weight","600");l.append("rect").attr("width",f).attr("height",x).attr("fill","none").attr("pointer-events","all").on("mousemove",function(c){const[q]=V(c),j=i.invert(q);if(j>=0&&j<=S){const C=b(j);v.style("display",null).attr("transform",`translate(${i(j)},${y(C)})`),X.text(`α=${j.toFixed(4)}, P=${(C*100).toFixed(1)}%`)}}).on("mouseout",function(){v.style("display","none")})},[k,r,m,b]),t.jsxs("div",{className:"my-8 p-6 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 rounded-xl shadow-lg border border-slate-200 dark:border-slate-700",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"Phase Transition Explorer"}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-3",children:"Explore the sharp phase transition in probability P(Coverage ≥ 1-ε) at critical threshold α_c. Adjust parameters to see the dramatic S-curve behavior predicted by Theorem 4.1."}),t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 text-xs text-slate-700 dark:text-slate-300",children:[t.jsx("p",{className:"font-semibold mb-2",children:"Parameter Guide:"}),t.jsxs("ul",{className:"space-y-1 ml-2",children:[t.jsxs("li",{children:[t.jsx("strong",{children:"|U|"})," (Unique entities): Number of distinct chemical entities in the library"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"R"})," (Redundancy): Average number of synthesis paths per unique entity (|S|/|U|)"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"ε"})," (Tolerance): Maximum acceptable fraction of uncovered entities (target coverage = 1-ε)"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"α_c"})," (Critical point): Sampling fraction where phase transition occurs = log(1/ε)/R"]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-1",children:["Unique Entities (|U|): ",e.toLocaleString()]}),t.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:"Larger |U| makes phase transition sharper"}),t.jsx("input",{type:"range",min:"1000",max:"1000000",step:"1000",value:e,onChange:d=>h(Number(d.target.value)),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-500 mt-1",children:[t.jsx("span",{children:"10³"}),t.jsx("span",{children:"10⁶"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-1",children:["Redundancy (R = |S|/|U|): ",s.toLocaleString()]}),t.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:"Higher R moves α_c left (fewer samples needed)"}),t.jsx("input",{type:"range",min:"10",max:"100000",step:"10",value:s,onChange:d=>u(Number(d.target.value)),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-500 mt-1",children:[t.jsx("span",{children:"10"}),t.jsx("span",{children:"10⁵"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-1",children:["Coverage Tolerance (ε): ",n.toFixed(3)]}),t.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:"Smaller ε moves α_c right (stricter coverage)"}),t.jsx("input",{type:"range",min:"0.001",max:"0.5",step:"0.001",value:n,onChange:d=>T(Number(d.target.value)),className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-500 mt-1",children:[t.jsx("span",{children:"0.001"}),t.jsx("span",{children:"0.5"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Synthesis Space (|S| = |U|×R)"}),t.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:g.toExponential(2)})]}),t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Samples Needed (α_c × |S|)"}),t.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:N.toLocaleString()})]}),t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Speedup (|S|/samples)"}),t.jsxs("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:[w>=100?Math.round(w).toLocaleString():w.toFixed(1),"×"]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg border border-yellow-300 dark:border-yellow-700",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Critical Point (α_c = log(1/ε)/R)"}),t.jsx("div",{className:"text-lg font-bold text-red-600 dark:text-red-400",children:r.toExponential(3)})]}),t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg border border-yellow-300 dark:border-yellow-700",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"True Inflection (α_infl)"}),t.jsx("div",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:m.toExponential(3)})]}),t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg border border-yellow-300 dark:border-yellow-700",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Probability at α_c (P)"}),t.jsxs("div",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:[(U*100).toFixed(1),"%"]})]}),t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg border border-yellow-300 dark:border-yellow-700",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Inflection Offset (%)"}),t.jsxs("div",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:[Math.abs(M)<.01?"< 0.01":M.toFixed(2),"%"]})]})]}),t.jsx("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-slate-300 dark:border-slate-600",children:t.jsx("svg",{ref:a,width:700,height:450,className:"mx-auto"})}),t.jsxs("div",{className:"mt-4 text-sm text-slate-600 dark:text-slate-400",children:[t.jsx("p",{children:t.jsx("strong",{children:"Interpretation:"})}),t.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[t.jsxs("li",{children:[t.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-semibold",children:"Blue curve"}),": Probability P(Coverage ≥ 1-ε) using exact Poisson CDF from Theorem 4.1"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-red-600 dark:text-red-400 font-semibold",children:"Red line"}),": Theoretical critical threshold α_c = log(1/ε)/R (where E[uncovered] = ε|U|)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-orange-600 dark:text-orange-400 font-semibold",children:"Orange line"}),": True inflection point α_infl = log(1/(ε + 1/|U|))/R (from calculus, shown if different)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-yellow-600 dark:text-yellow-400 font-semibold",children:"Yellow region"}),": Phase transition zone exhibiting sharp S-curve behavior"]}),t.jsx("li",{children:"For large |U|, α_c ≈ α_infl (offset → 0%). For small |U|, the offset is measurable."}),t.jsx("li",{children:"Hover over the curve to see exact probability values at each sampling fraction"})]})]})]})}export{tt as default};
