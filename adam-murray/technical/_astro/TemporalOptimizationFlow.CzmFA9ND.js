import{j as t}from"./jsx-runtime.TBa3i5EZ.js";import{r as g}from"./index.CVf8TyFT.js";import{s as G,l as E,a as U,f as L,b as V}from"./transform.Cr_jfbQC.js";import{w as W,c as v,a as J,x as K,y as Q,b as Z,l as O,m as D}from"./monotone.CFQ88-W1.js";function _(c,i,x){var u=null,M=v(!0),k=null,o=J,m=null,F=W(a);c=typeof c=="function"?c:c===void 0?K:v(+c),i=typeof i=="function"?i:i===void 0?v(0):v(+i),x=typeof x=="function"?x:x===void 0?Q:v(+x);function a(e){var n,w,N,b=(e=Z(e)).length,R,S=!1,s,d=new Array(b),p=new Array(b);for(k==null&&(m=o(s=F())),n=0;n<=b;++n){if(!(n<b&&M(R=e[n],n,e))===S)if(S=!S)w=n,m.areaStart(),m.lineStart();else{for(m.lineEnd(),m.lineStart(),N=n-1;N>=w;--N)m.point(d[N],p[N]);m.lineEnd(),m.areaEnd()}S&&(d[n]=+c(R,n,e),p[n]=+i(R,n,e),m.point(u?+u(R,n,e):d[n],x?+x(R,n,e):p[n]))}if(s)return m=null,s+""||null}function r(){return O().defined(M).curve(o).context(k)}return a.x=function(e){return arguments.length?(c=typeof e=="function"?e:v(+e),u=null,a):c},a.x0=function(e){return arguments.length?(c=typeof e=="function"?e:v(+e),a):c},a.x1=function(e){return arguments.length?(u=e==null?null:typeof e=="function"?e:v(+e),a):u},a.y=function(e){return arguments.length?(i=typeof e=="function"?e:v(+e),x=null,a):i},a.y0=function(e){return arguments.length?(i=typeof e=="function"?e:v(+e),a):i},a.y1=function(e){return arguments.length?(x=e==null?null:typeof e=="function"?e:v(+e),a):x},a.lineX0=a.lineY0=function(){return r().x(c).y(i)},a.lineY1=function(){return r().x(c).y(x)},a.lineX1=function(){return r().x(u).y(i)},a.defined=function(e){return arguments.length?(M=typeof e=="function"?e:v(!!e),a):M},a.curve=function(e){return arguments.length?(o=e,k!=null&&(m=o(k)),a):o},a.context=function(e){return arguments.length?(e==null?k=m=null:m=o(k=e),a):k},a}function nt(){const c=g.useRef(null),[i,x]=g.useState(!1),[u,M]=g.useState(0),k=g.useRef(),[o,m]=g.useState(.01),[F,a]=g.useState(100),[r,e]=g.useState(300),n=g.useMemo(()=>s=>50*Math.exp(-o*s/2),[o]),w=g.useMemo(()=>100/o*(1-Math.exp(-o*r/2))/r,[o,r]),N=g.useMemo(()=>s=>F*Math.exp(-o*s),[F,o]),b=g.useMemo(()=>{const s=[];for(let p=0;p<=200;p++){const h=p/200*r;s.push({t:h,rate:n(h),info:N(h)})}return s},[r,n,N]),R=g.useMemo(()=>b.reduce((d,p,h)=>{if(h===0)return 0;const f=b[h-1],j=p.t-f.t,y=(p.rate+f.rate)/2;return d+y*j},0),[b]);g.useEffect(()=>{if(!i)return;const s=()=>{M(d=>d>=r?(x(!1),r):d+.5),k.current=requestAnimationFrame(s)};return k.current=requestAnimationFrame(s),()=>{k.current&&cancelAnimationFrame(k.current)}},[i,r]);const S=()=>{x(!1),M(0)};return g.useEffect(()=>{if(!c.current||b.length===0)return;const s=G(c.current);s.selectAll("*").remove();const d={top:40,right:40,bottom:60,left:70},p=700-d.left-d.right,h=450-d.top-d.bottom,f=s.append("g").attr("transform",`translate(${d.left},${d.top})`),j=E().domain([0,r]).range([0,p]),y=E().domain([0,Math.max(...b.map(l=>l.rate))*1.1]).range([h,0]),$=U(j).ticks(10).tickFormat(l=>L(".0f")(l)),I=V(y).ticks(10).tickFormat(l=>L(".1f")(l));f.append("g").attr("transform",`translate(0,${h})`).call($).style("font-size","12px"),f.append("g").call(I).style("font-size","12px"),f.append("text").attr("x",p/2).attr("y",h+45).attr("text-anchor","middle").style("font-size","14px").style("font-weight","600").text("Time t"),f.append("text").attr("transform","rotate(-90)").attr("x",-h/2).attr("y",-50).attr("text-anchor","middle").style("font-size","14px").style("font-weight","600").text("Sampling Rate n(t)");const X=_().x(l=>j(l.t)).y0(h).y1(l=>y(l.rate)).curve(D),q=b.filter(l=>l.t<=u||!i);f.append("path").datum(q).attr("fill","rgba(59, 130, 246, 0.2)").attr("d",X);const B=O().x(l=>j(l.t)).y(l=>y(l.rate)).curve(D);if(f.append("path").datum(b).attr("fill","none").attr("stroke","#3b82f6").attr("stroke-width",3).attr("d",B),f.append("line").attr("x1",0).attr("x2",p).attr("y1",y(w)).attr("y2",y(w)).attr("stroke","#ef4444").attr("stroke-width",2).attr("stroke-dasharray","8,4"),i&&u<r){const l=n(u);f.append("line").attr("x1",j(u)).attr("x2",j(u)).attr("y1",0).attr("y2",h).attr("stroke","#10b981").attr("stroke-width",2).attr("stroke-dasharray","5,5"),f.append("circle").attr("cx",j(u)).attr("cy",y(l)).attr("r",6).attr("fill","#10b981").attr("stroke","#fff").attr("stroke-width",2)}const P=10,H=r/P;for(let l=1;l<P;l++){const T=l*H,A=n(T),Y=-o/2*n(T),z=20,C=Math.atan2(-Y*(h/r),z);f.append("line").attr("x1",j(T)).attr("y1",y(A)).attr("x2",j(T)+z*Math.cos(C)).attr("y2",y(A)+z*Math.sin(C)).attr("stroke","rgba(100, 100, 100, 0.5)").attr("stroke-width",1.5).attr("marker-end","url(#arrow)")}s.append("defs").append("marker").attr("id","arrow").attr("viewBox","0 -5 10 10").attr("refX",8).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("fill","rgba(100, 100, 100, 0.5)"),f.append("text").attr("x",j(r*.7)).attr("y",y(w)-10).attr("text-anchor","middle").style("font-size","11px").style("fill","#ef4444").style("font-weight","600").text("Uniform rate"),f.append("text").attr("x",j(r*.2)).attr("y",y(n(r*.2))-15).attr("text-anchor","middle").style("font-size","11px").style("fill","#3b82f6").style("font-weight","600").text("Optimal n*(t) ∝ exp(-λt/2)")},[b,w,r,n,u,i]),t.jsxs("div",{className:"my-8 p-6 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 rounded-xl shadow-lg border border-slate-200 dark:border-slate-700",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"Temporal Optimization Flow"}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:'Phase-space trajectory showing optimal sampling rate over time with exponential decay. The "front-loading principle": sample heavily early, then taper off.'})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:["Decay Rate λ: ",o.toFixed(4)]}),t.jsx("input",{type:"range",min:"0.001",max:"0.1",step:"0.001",value:o,onChange:s=>{m(Number(s.target.value)),S()},className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-500 mt-1",children:[t.jsx("span",{children:"0.001"}),t.jsx("span",{children:"0.1"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:["Time Horizon: ",r]}),t.jsx("input",{type:"range",min:"100",max:"500",step:"10",value:r,onChange:s=>{e(Number(s.target.value)),S()},className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-500 mt-1",children:[t.jsx("span",{children:"100"}),t.jsx("span",{children:"500"})]})]})]}),t.jsxs("div",{className:"flex gap-3 mb-6",children:[t.jsx("button",{onClick:()=>x(!i),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors",children:i?"Pause":u>=r?"Replay":"Play"}),t.jsx("button",{onClick:S,className:"px-6 py-2 bg-slate-600 hover:bg-slate-700 text-white font-semibold rounded-lg transition-colors",children:"Reset"}),t.jsx("div",{className:"flex-1"}),t.jsxs("div",{className:"flex items-center text-sm text-slate-700 dark:text-slate-300",children:[t.jsx("span",{className:"font-semibold mr-2",children:"Time:"}),t.jsxs("span",{children:[u.toFixed(1)," / ",r]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Total Samples (Optimal)"}),t.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:R.toFixed(1)})]}),t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Uniform Rate"}),t.jsxs("div",{className:"text-lg font-bold text-red-600 dark:text-red-400",children:[w.toFixed(2),"/time"]})]}),t.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-300 dark:border-slate-600",children:[t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-1",children:"Decay Half-life"}),t.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:(Math.log(2)/o).toFixed(1)})]})]}),t.jsx("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-slate-300 dark:border-slate-600",children:t.jsx("svg",{ref:c,width:700,height:450,className:"mx-auto"})}),t.jsxs("div",{className:"mt-4 text-sm text-slate-600 dark:text-slate-400",children:[t.jsx("p",{children:t.jsx("strong",{children:"Interpretation:"})}),t.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[t.jsxs("li",{children:[t.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-semibold",children:"Blue curve"}),": Optimal sampling rate n*(t) ∝ exp(-λt/2)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-red-600 dark:text-red-400 font-semibold",children:"Red dashed line"}),": Constant uniform sampling rate"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-semibold",children:"Shaded area"}),": Total samples acquired (area under curve)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-green-600 dark:text-green-400 font-semibold",children:"Green marker"}),": Current time position (during animation)"]}),t.jsx("li",{children:"Gray arrows show flow direction (exponential decay)"}),t.jsxs("li",{children:[t.jsx("strong",{children:"Front-loading principle:"})," Sample heavily when information is fresh, reduce rate as it decays"]})]})]})]})}export{nt as default};
