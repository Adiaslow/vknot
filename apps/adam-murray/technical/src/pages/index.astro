---
import { getCollection } from "astro:content";
import BlogLayout from "../layouts/BlogLayout.astro";
import ArticleHeader from "../components/ArticleHeader.astro";

// Get all blog posts and sort by date (newest first)
const allPosts = await getCollection("blog");
const posts = allPosts
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .map((post) => ({
    title: post.data.title,
    summary: post.data.description,
    publishDate: post.data.date.toISOString(),
    tags: post.data.tags,
    href: `/adam-murray/technical/posts/${post.slug}`,
    readingTimeMinutes: post.data.readingTimeMinutes,
  }));
---

<BlogLayout
  title="Adam Murray â€” Technical"
  description="Technical writing, engineering notebooks, and reproducible experiments."
>
  <section class="flex flex-col gap-6">
    <header class="flex flex-col gap-2">
      <h1 class="text-3xl font-semibold text-slate-900">Recent Posts</h1>
      <p class="text-slate-600">
        Production-minded writing on front-end systems, creative tooling, and
        research engineering.
      </p>
    </header>
    <div class="flex flex-col gap-8">
      {
        posts.map((post) => (
          <a
            href={post.href}
            class="flex flex-col gap-4 rounded-2xl border border-slate-200 bg-white p-8 shadow-sm transition-all hover:border-slate-300 hover:shadow-md"
          >
            <ArticleHeader
              title={post.title}
              summary={post.summary}
              publishDate={post.publishDate}
              showTags={false}
              readingTimeMinutes={post.readingTimeMinutes}
            />
            <div class="flex flex-wrap items-center gap-3 text-xs uppercase tracking-[0.3em]">
              {post.tags.map((tag) => (
                <span class="rounded-full bg-slate-900 px-3 py-1 text-white" data-tag={tag}>
                  {tag}
                </span>
              ))}
            </div>
          </a>
        ))
      }
    </div>
  </section>
</BlogLayout>
