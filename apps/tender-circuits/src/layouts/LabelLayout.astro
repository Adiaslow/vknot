---
import { Navigation, SEO } from "@vknot/ui";
import "../styles/velvet.css";

export interface Props {
  readonly title: string;
  readonly description?: string;
}

const { title, description } = Astro.props;
---

<html lang="en" class="bg-slate-950 text-slate-50">
  <head>
    <SEO
      title={title}
      description={description ??
        "Independent music label and audiovisual collective."}
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
    />
  </head>
  <body class="min-h-screen velvet-background text-slate-50">
    <!-- SVG Filters for Liquid Glass Effect -->
    <svg style="position: absolute; width: 0; height: 0;">
      <defs>
        <filter
          id="glass-distortion"
          x="-20%"
          y="-20%"
          width="140%"
          height="140%"
          filterUnits="objectBoundingBox"
        >
          <!-- Create edge detection from alpha channel -->
          <feGaussianBlur in="SourceAlpha" stdDeviation="8" result="blurred" />

          <!-- Invert to make edges bright, center dark -->
          <feComponentTransfer in="blurred" result="edgeMask">
            <feFuncA type="table" tableValues="1 0" />
          </feComponentTransfer>

          <!-- Create radial displacement map for beveled glass edges -->
          <feMorphology operator="erode" radius="2" in="SourceAlpha" result="inner" />
          <feGaussianBlur in="inner" stdDeviation="10" result="innerBlur" />

          <feComponentTransfer in="innerBlur" result="displacementMap">
            <feFuncR type="table" tableValues="0.5 1" />
            <feFuncG type="table" tableValues="0.5 1" />
            <feFuncB type="discrete" tableValues="0" />
            <feFuncA type="table" tableValues="1 0" />
          </feComponentTransfer>

          <!-- Apply subtle radial displacement from edges -->
          <feDisplacementMap
            in="SourceGraphic"
            in2="displacementMap"
            scale="8"
            xChannelSelector="R"
            yChannelSelector="G"
          />
        </filter>
      </defs>
    </svg>

    <!-- Three.js Fur Background Canvas -->
    <canvas
      id="fur-background"
      style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none;"
    ></canvas>

    <Navigation
      theme="music"
      siteName="Tender Circuits"
      baseUrl="/tender_circuits"
      links={[
        { href: "/tender_circuits", label: "Home" },
        { href: "/tender_circuits/artists", label: "Artists" },
        { href: "/tender_circuits/releases", label: "Releases" },
      ]}
    />
    <main
      class="mx-auto flex w-full max-w-5xl flex-col gap-12 px-6 pb-24 pt-16"
    >
      <slot />
    </main>
    <footer class="py-10 mt-12">
      <div class="mx-auto flex w-full max-w-5xl flex-col gap-4 px-6">
        <div class="card rounded-2xl p-8">
          <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
            <div class="flex flex-col gap-2">
              <p class="text-sm font-medium" style="color: #f5f1ea;">Tender Circuits</p>
              <p class="text-xs" style="color: #a39074;">Independent experimental music label</p>
            </div>
            <div class="flex flex-col gap-2 text-xs" style="color: #a39074;">
              <p>Â© {new Date().getFullYear()} Tender Circuits</p>
              <p>All rights reserved</p>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Three.js Fur Background System -->
    <script>
      import "../scripts/three-fur-background.ts";
    </script>

    <!-- Smooth Momentum Scrolling -->
    <script>
      import "../scripts/smooth-scroll.ts";
    </script>
  </body>
</html>
